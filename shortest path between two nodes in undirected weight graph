#include <bits/stdc++.h>

using namespace std;

int const N = 1e4 + 1;
int const M = 1e9 + 1;
int n, m, cost[N];
bool vis[N];
vector<vector<pair<int, int> > > g;
priority_queue<pair<int, int> > q;

void Dijkstra(int src) {
    int v, c;
    
    cost[src] = 0;
    q.push(make_pair(0, src));
    
    while(!q.empty()) {
        v = q.top().second;
        c = -q.top().first;
        q.pop();
        
        if(vis[v]) continue;
        vis[v] = true;
        
        for(int i = 0; i < g[v].size(); i++)
            if(g[v][i].second + c < cost[g[v][i].first]) {
                cost[g[v][i].first] = g[v][i].second + c;
                q.push(make_pair(-(g[v][i].second + c), g[v][i].first));
            }
    }
}

int main() {
    int t;
    scanf("%d", &t);
    
    while(t--) {
        
        scanf("%d%d", &n, &m);
        
        g.clear();
        g.resize(n);
        while(!q.empty()) q.pop();
        for(int i = 0; i < n; i++) cost[i] = M;
        memset(vis, false, sizeof vis);
        
        int v, u, c;
        for(int i=1;i<=n;i++)
        {
            for(int j=i+1;j<=n;j++)
            {
                if(i==1)
                {
                    v=i;
                    u=j;
                    v--;
                    u--;
                    c=n+1;
                    g[v].push_back(make_pair(u, c));
                    g[u].push_back(make_pair(v,c));
                    // cout<<v<<" "<<u<<" "<<c<<"k";
                }
                else if(i%j==0 || j%i==0)
                {
                    
                    v=i;
                    v--;
                    u=j;
                    u--;
                    c=1;
                    g[v].push_back(make_pair(u, c));
                    g[u].push_back(make_pair(v,c));
                    // cout<<v<<" "<<u<<" "<<c<<"k";
                }
            }
        }
        vector<vector<int>>q1;
        for(int i=0;i<m;i++)
        {
            int a,b;
            cin>>a>>b;
            vector<int>k;
            a--;
            b--;
            k.push_back(a);
            k.push_back(b);
            q1.push_back(k);
            
        }
        
        for(int i=0;i<m;i++)
        {
            Dijkstra(q1[i][0]);
        
            if(cost[q1[i][1]] == M) puts("NO");
            else printf("%d ", cost[q1[i][1]]);
            for(int i = 0; i < n; i++) cost[i] = M;
            memset(vis, false, sizeof vis);
        }
        cout<<endl;
    }
    
    return 0;
}
